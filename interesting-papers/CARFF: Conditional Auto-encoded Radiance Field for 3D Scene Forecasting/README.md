# CARFF: Conditional Auto-encoded Radiance Field for 3D Scene Forecasting
[paper link](https://arxiv.org/pdf/2401.18075) 
| Year | Introduction                                                         | Research Field                 |
| ---- | ------------------------------------------------------------ | -------------------- |
| 2024 | This paper presents a method called CARFF (Conditional Auto-encoded Radiance Field for 3D Scene Forecasting) for predicting future 3D scenes.          |         Deep Learning |

## Methodology

### 1. Abstract
The method maps 2D images observed in the past to a distribution of possible 3D scene configurations and infers hypothetical scene changes through time. This method uses Neural Radiation Fields (NeRF) to represent the 3D scene model, taking into account the complexity of the environmental state and dynamics. The authors used two stages of training, including the learning of pose-conditional variational self-encoders and NeRFs and autoregressive ground prediction of potential scene representations using a hybrid density network. Experiments were conducted on the CARLA driving simulator to demonstrate the ability of the method for efficient trajectory planning and alternative formulation in multi-agent autonomous driving scenarios.

### 2. Method Description 
This thesis proposes a deep learning-based 3D scene prediction model that enables modelling and prediction of 3D scenes in dynamic environments by combining deep learning with probabilistic models. Specifically, the method adopts a two-stage training framework: firstly, PC-VAE is used to learn the visually invariant representation of the scene; then NeRF is utilised to learn the 3D scene and an MDN is constructed on the posterior distribution of the encoder to predict the future scene distribution. This approach is effective in handling complex scenes and enables decision-making in unknown situations.
![image](https://github.com/user-attachments/assets/0628e660-a90e-462b-a420-15e364dae697)

### 3. Methodological improvements
Compared with traditional deep learning methods, the method adopts the idea of probabilistic modelling, which makes the model more robust and interpretable. At the same time, the method also adopts the delay linearity KL scatter loss weight scheduling strategy to balance the stability and accuracy of the model. In addition, the method introduces MDN for future scenario prediction, which further improves the accuracy and generalisation of the model.

### 4. Issues addressed 
Traditional methods are often difficult to handle complex and changing scenes and are prone to overfitting or underfitting. In contrast, by combining the advantages of deep learning and probabilistic modelling, the method can effectively capture the changes and uncertainties in the scene, thus achieving more accurate and reliable 3D scene prediction. In addition, the method can be applied in the fields of automatic driving and robot navigation, providing technical support for industries such as intelligent transport and intelligent manufacturing.

## Experiments
This paper describes the authors' use of the CARFF model for decision making and planning tasks in driving scenarios. The authors conducted several experiments to validate the performance of the CARFF model and compare it with other related methods.

Firstly, the authors tested the CARFF model on a simple synthetic dataset to validate its predictive power and its ability to process partially observable inputs. 

Second, in the CARLA simulation environment, the authors designed three different driving scenarios for testing, including a single intersection, a multi-scenario intersection, and a two-lane merge situation. These scenarios contain state uncertainty and dynamic uncertainty factors, such as the probability of the presence of obstacles and changes in vehicle speed. Finally, the authors also show how the CARFF model can be applied to a hand-operated dataset.

![image](https://github.com/user-attachments/assets/c1da7bf6-c3ec-434b-96b4-3c1d8ca0f85a)

For each scenario, the authors use the mean peak signal-to-noise ratio (PSNR) to assess the predictive quality of the model and the t-SNE visualisation tool to analyse the latent distributions generated by the model. In addition, the authors use Support Vector Machines (SVMs) to measure the quality of the visualisation clustering and accuracy curves to assess the performance of the model under different sample sizes.

Overall, this paper demonstrates that the CARFF model is strong in processing partially observable inputs and predicting future states 

![image](https://github.com/user-attachments/assets/17d3cdfd-c8a2-4115-af4f-3069178f8868)

## Conclusion

### 1. Advantages of the Thesis
  1. The paper proposes a method called CARFF, which enables path planning in complex dynamic environments based on visual perception by combining deep learning techniques and traditional planning algorithms.
  2. In terms of method design, the paper proposes a mixed density network (MDN) to predict future scenes and uses a neural radiation field (NeRF) model to reconstruct object positions and shapes in the scene.
  3. Experimental results show that the method outperforms other related methods on multiple datasets, especially with high accuracy and robustness in complex dynamic environments.

### 2. Innovative points
  1. The CARFF method proposed in this thesis is a new path planning method, which combines deep learning techniques with traditional planning algorithms, and is able to effectively deal with path planning problems in complex dynamic environments.
  2. The method employs a mixed density network (MDN) to predict future scenarios, allowing the model to better adapt to different scenario changes.
  3. The method also uses a Neural Radiation Field (NeRF) model to reconstruct the positions and shapes of objects in the scene, which improves the accuracy of path planning.

### 3. Future Works
  1. The method proposed in this paper has achieved better results on several datasets, but still has some limitations, e.g., for very complex dynamic environments more training data may be needed to achieve better results.
  2. Future research directions include further improving the generalisation ability of the model so that it can better adapt to a variety of different scenarios; and exploring how to combine the method with other path planning algorithms to achieve more efficient and accurate path planning.  
